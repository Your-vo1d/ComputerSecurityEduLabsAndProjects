# Лабораторная работа: Арифметическое кодирование

## Цель работы
1. Реализовать алгоритм арифметического кодирования для сжатия текстовых данных
2. Изучить принципы работы с вероятностными моделями
3. Разработать методы эффективного сохранения и восстановления данных
4. Оценить степень сжатия и корректность работы алгоритма

## Описание алгоритма

### Основные принципы
Арифметическое кодирование представляет данные в виде дробного числа от 0 до 1. Каждый символ сужает текущий интервал согласно своей вероятности встречаемости. В результате получается одно число, представляющее все сообщение.

### Ключевые этапы
1. **Анализ частот символов** - подсчет встречаемости каждого символа
2. **Построение таблицы диапазонов** - каждому символу ставится в соответствие интервал
3. **Процесс кодирования** - последовательное сужение интервала
4. **Нормализация** - предотвращение переполнения и сохранение точности
5. **Сохранение данных** - запись служебной информации и закодированного сообщения

## Структура программы

### Основные функции

#### `encode(input_file, encode_file)`
- **Назначение**: Сжатие данных с использованием арифметического кодирования
- **Алгоритм**:
  1. Чтение и анализ входных данных
  2. Построение таблицы диапазонов символов
  3. Итеративное сужение интервала [low, high)
  4. Нормализация интервала
  5. Сохранение:
     - Количество символов
     - Таблицу частот
     - Закодированные биты

#### `decode(encode_file, decode_file)`
- **Назначение**: Восстановление исходных данных
- **Алгоритм**:
  1. Чтение таблицы частот
  2. Восстановление таблицы диапазонов
  3. Итеративное декодирование символов
  4. Нормализация интервала
  5. Сохранение восстановленных данных

### Формат сжатого файла
1. **2 байта**: количество символов в тексте
2. **Таблица частот**:
   - Для каждого символа:
     - 1 байт: длина символа в байтах
     - N байт: сам символ (UTF-8)
     - 4 байта: частота символа
3. **Разделитель**: 0xFF
4. **2 байта**: длина битовой последовательности
5. **Битовая последовательность**: закодированные данные

## Пример работы

### Входные данные
```
This is an example of arithmetic coding
```

### Шаги сжатия:
1. Подсчет частот символов (пробел - 6, 'i' - 3 и т.д.)
2. Построение таблицы диапазонов:
   - ' ' → [0, 6)
   - 'i' → [6, 9) 
   - и т.д.
3. Кодирование первого символа 'T' (диапазон [X, Y))
4. Последовательное сужение интервала для каждого символа
5. Нормализация и сохранение

### Результат:
- Размер исходного файла: 100 байт
- Размер сжатого файла: ~65 байт
- Степень сжатия: ~35%

## Особенности реализации
1. Поддержка UTF-8 символов
2. Использование 16-битного интервала (0-65535)
3. Механизм нормализации для предотвращения переполнения
4. Оптимальное хранение таблицы частот
5. Автоматическое создание папки для результатов

## Инструкция по использованию
1. Поместите исходный файл в ту же директорию, что и программу
2. Запустите программу: `python arithmetic_coding.py`
3. Введите имя файла при запросе
4. Результаты будут сохранены в папке `result/`:
   - `encode.txt` - сжатые данные
   - `decode.txt` - восстановленные данные

## Ограничения
1. Максимальная длина текста ограничена 65535 символами (2 байта)
2. Для маленьких файлов сжатый результат может быть больше исходного
3. Требуется точное соответствие таблиц частот при кодировании/декодировании

## Сравнение с алгоритмом Хаффмана
1. Более высокая степень сжатия (особенно для данных с высокой избыточностью)
2. Более сложная реализация
3. Менее устойчив к ошибкам в закодированных данных
4. Требует больше вычислительных ресурсов